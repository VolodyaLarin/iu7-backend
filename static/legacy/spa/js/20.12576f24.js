(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"2ff9":function(a,e,t){"use strict";t.r(e);var n=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("q-page",{staticClass:"q-pa-lg"},[t("div",[t("q-card",[t("div",{staticClass:"row justify-center"},[a._e(),t("div",{staticClass:"col-md-9 q-pa-md"},[t("p",{staticClass:"text-h2"},[a._v("\n            Профиль\n          ")]),a.user.data.contingent?t("p",[a._v("\n            Ваша учетная запись синхронизированна с ЭУ.\n          ")]):t("p",[a._v("\n            Ваша учетная запись не синхронизированна с ЭУ. Обратитесь к\n            администратору сайта @volodyalarin\n          ")]),t("q-input",{attrs:{filled:"",label:"Фамилия",readonly:""},model:{value:a.user.data.contingent.surname,callback:function(e){a.$set(a.user.data.contingent,"surname",e)},expression:"user.data.contingent.surname"}}),t("q-input",{attrs:{filled:"",label:"Имя",readonly:""},model:{value:a.user.data.contingent.name,callback:function(e){a.$set(a.user.data.contingent,"name",e)},expression:"user.data.contingent.name"}}),t("q-input",{attrs:{filled:"",label:"Отчество",readonly:""},model:{value:a.user.data.contingent.secname,callback:function(e){a.$set(a.user.data.contingent,"secname",e)},expression:"user.data.contingent.secname"}}),t("q-input",{attrs:{filled:"",label:"Дата рождения",readonly:""},model:{value:a.user.data.contingent.birthday,callback:function(e){a.$set(a.user.data.contingent,"birthday",e)},expression:"user.data.contingent.birthday"}}),t("q-input",{attrs:{filled:"",label:"Группа",readonly:""},model:{value:a.user.data.contingent.group,callback:function(e){a.$set(a.user.data.contingent,"group",e)},expression:"user.data.contingent.group"}}),t("q-input",{attrs:{filled:"",label:"Номер студенческого билета",readonly:""},model:{value:a.user.data.contingent.login,callback:function(e){a.$set(a.user.data.contingent,"login",e)},expression:"user.data.contingent.login"}}),t("q-field",{attrs:{filled:"",label:"Бауманская почта",readonly:"","stack-label":""},scopedSlots:a._u([{key:"control",fn:function(){return[t("div",{staticClass:"self-center full-width no-outline",attrs:{tabindex:"0"}},[a._v("\n                "+a._s(a.user.data.login)+"@student.bmstu.ru\n              ")])]},proxy:!0}])}),a.user.data.student?t("div",[t("div",{staticClass:"q-mt-lg"},[a._v("Дополнительные данные:")]),a._l(a.fields,(function(e,n){return t("div",{key:n},[t("q-input",{attrs:{filled:"",label:e.fieldLabel,readonly:""},model:{value:a.user.data.student[e.fieldName],callback:function(t){a.$set(a.user.data.student,e.fieldName,t)},expression:"user.data.student[field.fieldName]"}})],1)}))],2):a._e()],1)]),t("q-card-section")],1),t("q-dialog",{model:{value:a.uploadImageModalFlag,callback:function(e){a.uploadImageModalFlag=e},expression:"uploadImageModalFlag"}},[t("q-card",[t("q-card-section",[t("div",{staticClass:"text-h6"},[a._v("Загрузить новую фотографию")])]),t("q-card-section",{staticClass:"q-pt-none"},[t("q-file",{attrs:{color:"purple-12",label:"Загрузить фото"},on:{input:a.uploadPhoto},scopedSlots:a._u([{key:"prepend",fn:function(){return[t("q-icon",{attrs:{name:"attach_file",accept:".jpg, .png"}})]},proxy:!0}]),model:{value:a.photo,callback:function(e){a.photo=e},expression:"photo"}})],1)],1)],1)],1)])},l=[],o=t("967e"),s=t.n(o),i=(t("96cf"),t("fa84")),d=t.n(i),u={name:"Profile",created:function(){this.loadFields()},data:function(){return{uploadImageModal:"",photo:null,uploadImageModalFlag:!1,fields:[]}},computed:{user:function(){return this.$store.state.user}},watch:{uploadImageModal:function(a){this.uploadImageModalFlag=!!a},uploadImageModalFlag:function(a){a||(this.uploadImageModal=null)}},methods:{loadFields:function(){var a=this;return d()(s.a.mark((function e(){var t;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.$axios("/group/fields");case 2:t=e.sent,a.fields=t.data;case 4:case"end":return e.stop()}}),e)})))()},uploadPhoto:function(){var a=this;this.$q.loading.show({message:"Загрузка фотографии",sanitize:!0});var e=new FormData;e.append("photo",this.photo),this.$axios.post("/user/"+this.uploadImageModal,e).then((function(){a.$store.dispatch("user/update"),a.photo=null,a.uploadImageModal=!1,a.$q.notify("Фото успешно загружено"),a.$q.loading.hide()})).catch((function(){a.$q.notify("Произошла ошибка загрузки"),a.photo=null,a.$q.loading.hide()}))}}},r=u,c=t("2877"),p=t("9989"),f=t("f09f"),g=t("068f"),m=t("9c40"),h=t("27f9"),v=t("8572"),b=t("a370"),q=t("24e8"),y=t("7d53"),x=t("0016"),$=t("eebe"),k=t.n($),_=Object(c["a"])(r,n,l,!1,null,null,null);e["default"]=_.exports;k()(_,"components",{QPage:p["a"],QCard:f["a"],QImg:g["a"],QBtn:m["a"],QInput:h["a"],QField:v["a"],QCardSection:b["a"],QDialog:q["a"],QFile:y["a"],QIcon:x["a"]})}}]);